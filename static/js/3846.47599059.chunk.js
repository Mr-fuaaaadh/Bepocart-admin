"use strict";(self.webpackChunkflexy=self.webpackChunkflexy||[]).push([[3846],{3846:(e,a,r)=>{r.r(a),r.d(a,{default:()=>E});var t=r(2903),n=r(2791),s=r(697),l=r(7621),o=r(9504),i=r(890),d=r(8550),c=r(8096),h=r(4925),x=r(8406),u=r(3786),p=r(4518),Z=r(5403),j=r(7689),m=r(1087),g=r(9836),v=r(6890),y=r(5855),f=r(3994),b=r(3382),C=r(6812),w=r(2058),P=r(1137),S=r(184);const W=e=>{switch(e){case"pending":return"red";case"Processing":return"yellow";case"Packing":return"blue";case"Completed":return"green";case"Refunded":return"orange";case"Cancelled":return"grey";default:return"inherit"}},I=(e,a)=>{if(!a)return e;return e.split(new RegExp("(".concat(a,")"),"gi")).map(((e,r)=>e.toLowerCase()===a.toLowerCase()?(0,S.jsx)("span",{style:{backgroundColor:"yellow"},children:e},r):e))},k=e=>{let{searchQuery:a}=e;const[r,l]=(0,n.useState)([]),[o,d]=(0,n.useState)(!0),[c,h]=(0,n.useState)(null),[Z,k]=(0,n.useState)(0),[E,_]=(0,n.useState)(10),R=(0,j.s0)(),D=localStorage.getItem("token");(0,n.useEffect)((()=>{(async()=>{try{const e=await t.Z.get("https://bepocart.in/admin/Bepocart-Orders/",{headers:{Authorization:"".concat(D)}});Array.isArray(e.data.data)?l(e.data.data):(console.error("Invalid data format:",e.data.data),h("Invalid data format received"))}catch(c){console.error("Error fetching products:",c),!c.response||401!==c.response.status&&403!==c.response.status?h("Error fetching orders"):R("/login")}finally{d(!1)}})()}),[R]);const L=r.filter((e=>e.customerName&&e.customerName.toLowerCase().includes(a.toLowerCase())||e.created_at&&e.created_at.toLowerCase().includes(a.toLowerCase())));return(0,S.jsx)(S.Fragment,{children:o?(0,S.jsx)(s.Z,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"200px"},children:(0,S.jsx)(i.Z,{variant:"body1",children:"Loading..."})}):c?(0,S.jsx)(i.Z,{variant:"body1",color:"error",children:c}):(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(g.Z,{"aria-label":"simple table",sx:{mt:3,whiteSpace:"nowrap"},children:[(0,S.jsx)(v.Z,{children:(0,S.jsxs)(y.Z,{children:[(0,S.jsx)(f.Z,{children:"Id"}),(0,S.jsx)(f.Z,{children:"ORDER ID"}),(0,S.jsx)(f.Z,{children:"TIME"}),(0,S.jsx)(f.Z,{children:"CUSTOMER NAME"}),(0,S.jsx)(f.Z,{children:"Customer Image"}),(0,S.jsx)(f.Z,{children:"DATE"}),(0,S.jsx)(f.Z,{children:"Total Amount"}),(0,S.jsx)(f.Z,{children:"Status"}),(0,S.jsx)(f.Z,{children:"Coupon"}),(0,S.jsx)(f.Z,{children:"Payment Method"}),(0,S.jsx)(f.Z,{children:"Payment ID"}),(0,S.jsx)(f.Z,{children:"Order ID"}),(0,S.jsx)(f.Z,{children:"Orders"})]})}),(0,S.jsx)(b.Z,{children:L.slice(Z*E,Z*E+E).map((e=>(0,S.jsxs)(y.Z,{children:[(0,S.jsx)(f.Z,{children:e.id}),(0,S.jsx)(f.Z,{children:(0,S.jsx)(s.Z,{sx:{maxWidth:"150px"},children:(0,S.jsx)(m.rU,{to:"/order-bill/".concat(e.order_id,"/"),style:{textDecoration:"none",color:"inherit"},children:(0,S.jsx)(i.Z,{variant:"body1",noWrap:!0,children:I(e.order_id,a)})})})}),(0,S.jsx)(f.Z,{children:(0,S.jsx)(s.Z,{sx:{maxWidth:"150px"},children:(0,S.jsx)(i.Z,{variant:"body1",noWrap:!0,children:e.created_time})})}),(0,S.jsx)(f.Z,{children:(0,S.jsx)(s.Z,{sx:{maxWidth:"150px"},children:(0,S.jsx)(i.Z,{variant:"body1",noWrap:!0,children:I(e.customerName,a)})})}),(0,S.jsx)(f.Z,{children:(0,S.jsx)("img",{src:"".concat(e.customerImage),alt:e.customerName,style:{maxWidth:"50px",maxHeight:"50px"}})}),(0,S.jsx)(f.Z,{children:(0,S.jsx)(s.Z,{sx:{maxWidth:"250px"},children:(0,S.jsx)(i.Z,{variant:"body1",children:I(e.created_at,a)})})}),(0,S.jsx)(f.Z,{children:(0,S.jsx)(s.Z,{sx:{maxWidth:"150px"},children:(0,S.jsx)(i.Z,{variant:"body1",noWrap:!0,children:e.total_amount})})}),(0,S.jsx)(f.Z,{children:(0,S.jsxs)(x.Z,{value:e.status,onChange:a=>(async(e,a)=>{try{await t.Z.put("https://bepocart.in/admin/Bepocart-Order-status-update/".concat(e,"/"),{status:a},{headers:{Authorization:"".concat(D)}}),l((r=>r.map((r=>r.id===e?{...r,status:a}:r))))}catch(c){console.error("Error updating order status:",c)}})(e.id,a.target.value),displayEmpty:!0,inputProps:{"aria-label":"Without label"},size:"small",sx:{color:W(e.status),minWidth:"120px"},children:[(0,S.jsx)(u.Z,{value:"pending",children:"Pending"}),(0,S.jsx)(u.Z,{value:"Processing",children:"Processing"}),(0,S.jsx)(u.Z,{value:"Packing",children:"Packing"}),(0,S.jsx)(u.Z,{value:"Completed",children:"Completed"}),(0,S.jsx)(u.Z,{value:"Refunded",children:"Refunded"}),(0,S.jsx)(u.Z,{value:"Cancelled",children:"Cancelled"})]})}),(0,S.jsx)(f.Z,{children:(0,S.jsx)(s.Z,{sx:{maxWidth:"150px"},children:(0,S.jsxs)(i.Z,{variant:"body1",noWrap:!0,sx:{color:e.couponName?"inherit":"red"},children:[(0,S.jsx)(P.Z,{sx:{mr:1}}),e.couponName?e.couponName:"No coupon "]})})}),(0,S.jsx)(f.Z,{children:(0,S.jsx)(s.Z,{sx:{maxWidth:"150px"},children:(0,S.jsx)(i.Z,{variant:"body1",noWrap:!0,sx:{color:"COD"===e.payment_method?"green":"razorpay"===e.payment_method?"blue":"inherit"},children:e.payment_method})})}),(0,S.jsx)(f.Z,{children:(0,S.jsx)(s.Z,{sx:{maxWidth:"150px"},children:(0,S.jsx)(i.Z,{variant:"body1",noWrap:!0,children:e.payment_id})})}),(0,S.jsx)(f.Z,{children:(0,S.jsx)(s.Z,{sx:{maxWidth:"150px"},children:(0,S.jsx)(i.Z,{variant:"body1",noWrap:!0,children:e.razorpay_order_id})})}),(0,S.jsx)(f.Z,{children:(0,S.jsx)(p.Z,{variant:"contained",color:"primary",startIcon:(0,S.jsx)(w.Z,{}),sx:{mt:1},onClick:()=>R("/product-image-form/".concat(e.id,"/")),children:"View"})})]},e.id)))})]}),(0,S.jsx)(C.Z,{rowsPerPageOptions:[10,25,50],component:"div",count:L.length,rowsPerPage:E,page:Z,onPageChange:(e,a)=>{k(a)},onRowsPerPageChange:e=>{_(parseInt(e.target.value,10)),k(0)}})]})})},E=()=>{const[e,a]=(0,n.useState)(""),[r,j]=(0,n.useState)(""),[m,g]=(0,n.useState)(""),[v,y]=(0,n.useState)(""),[f,b]=(0,n.useState)("");return(0,S.jsx)(s.Z,{position:"relative",children:(0,S.jsx)(l.Z,{variant:"outlined",children:(0,S.jsxs)(o.Z,{children:[(0,S.jsx)(i.Z,{variant:"h3",children:"Orders Table"}),(0,S.jsxs)(s.Z,{my:5,display:"flex",alignItems:"center",gap:2,children:[(0,S.jsx)(d.Z,{label:"Search",placeholder:"Search by username / date",variant:"outlined",size:"small",value:e,onChange:e=>{a(e.target.value)}}),(0,S.jsx)(d.Z,{label:"Start Date",type:"date",variant:"outlined",size:"small",InputLabelProps:{shrink:!0},value:r,onChange:e=>{j(e.target.value)}}),(0,S.jsx)(d.Z,{label:"End Date",type:"date",variant:"outlined",size:"small",InputLabelProps:{shrink:!0},value:m,onChange:e=>{g(e.target.value)}}),(0,S.jsxs)(c.Z,{variant:"outlined",size:"small",children:[(0,S.jsx)(h.Z,{children:"Status"}),(0,S.jsxs)(x.Z,{value:v,onChange:e=>{y(e.target.value)},label:"Status",children:[(0,S.jsx)(u.Z,{value:"",children:"All"}),(0,S.jsx)(u.Z,{value:"pending",children:"Pending"}),(0,S.jsx)(u.Z,{value:"processing",children:"Processing"}),(0,S.jsx)(u.Z,{value:"packing",children:"Packing"}),(0,S.jsx)(u.Z,{value:"completed",children:"Completed"}),(0,S.jsx)(u.Z,{value:"refunded",children:"Refunded"}),(0,S.jsx)(u.Z,{value:"cancelled",children:"Cancelled"})]})]}),(0,S.jsx)(p.Z,{variant:"contained",color:"primary",onClick:()=>{const a={searchQuery:e,startDate:r,endDate:m,status:v};console.log("Request Body:",a),t.Z.post("https://bepocart.in/admin/export-orders/",a,{responseType:"blob"}).then((e=>{const a=new Blob([e.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),t=document.createElement("a");t.href=window.URL.createObjectURL(a),t.download="orders_".concat(r,"_to_").concat(m,".xlsx"),document.body.appendChild(t),t.click(),document.body.removeChild(t),alert("Excel file downloaded successfully.")})).catch((e=>{console.error("Error sending data:",e),alert("Failed to generate Excel file. Please try again.")})),b(e)},startIcon:(0,S.jsx)(Z.Z,{}),children:"Submit"})]}),(0,S.jsx)(s.Z,{sx:{overflowX:"auto",overflowY:"auto",whiteSpace:"nowrap",maxWidth:"100%",maxHeight:"800px"},children:(0,S.jsx)(k,{searchQuery:f,startDate:r,endDate:m,status:v})})]})})})}},5403:(e,a,r)=>{var t=r(4836);a.Z=void 0;var n=t(r(5649)),s=r(184),l=(0,n.default)((0,s.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"}),"Search");a.Z=l},7621:(e,a,r)=>{r.d(a,{Z:()=>m});var t=r(7462),n=r(3366),s=r(2791),l=r(9278),o=r(4419),i=r(6934),d=r(1020),c=r(5527),h=r(5878),x=r(1217);function u(e){return(0,x.ZP)("MuiCard",e)}(0,h.Z)("MuiCard",["root"]);var p=r(184);const Z=["className","raised"],j=(0,i.ZP)(c.Z,{name:"MuiCard",slot:"Root",overridesResolver:(e,a)=>a.root})((()=>({overflow:"hidden"}))),m=s.forwardRef((function(e,a){const r=(0,d.i)({props:e,name:"MuiCard"}),{className:s,raised:i=!1}=r,c=(0,n.Z)(r,Z),h=(0,t.Z)({},r,{raised:i}),x=(e=>{const{classes:a}=e;return(0,o.Z)({root:["root"]},u,a)})(h);return(0,p.jsx)(j,(0,t.Z)({className:(0,l.Z)(x.root,s),elevation:i?8:void 0,ref:a,ownerState:h},c))}))}}]);
//# sourceMappingURL=3846.47599059.chunk.js.map